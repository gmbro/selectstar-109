document.addEventListener('DOMContentLoaded', () => {
    const phoneForm = document.getElementById('phone-form');
    const phoneInput = document.getElementById('phone-input');
    const testNumberInput = document.getElementById('test-number');
    const rxCodeInput = document.getElementById('rx-code');
    const txCodeInput = document.getElementById('tx-code');
    const copyRxButton = document.getElementById('copy-rx');
    const copyTxButton = document.getElementById('copy-tx');
    const resultMessage = document.getElementById('result-message');
    const testPageButton = document.getElementById('test-page-button');

    const database = {
        '01090897889': 'TEST1',
        '01081095964': 'TEST2',
        '01040644383': 'TEST3',
        '01092614553': 'TEST4',
        '01092158858': 'TEST5',
        '01039754572': 'TEST6',
        '01058428275': 'TEST7',
        '01037385080': 'TEST8',
        '01054186255': 'TEST9',
        '01053103428': 'TEST10',
        '01036645646': 'TEST11',
        '01031169041': 'TEST12',
        '01028621986': 'TEST13',
        '01085166751': 'TEST14',
        '01038271505': 'TEST15',
        '01055670650': 'TEST16',
        '01099991250': 'TEST17',
        '01075318382': 'TEST18',
        '01062723939': 'TEST19',
        '01048077880': 'TEST20',
        '01056750882': 'TEST21',
        '01077436543': 'TEST22',
        '01038368434': 'TEST23',
        '01051695254': 'TEST24',
        '01027960308': 'TEST25',
        '01032239263': 'TEST26',
        '01028011673': 'TEST27',
        '01051490660': 'TEST28',
    };

    const rxCodes = [
        '3096578925', '6261703703', '5919777370', '3648027504', '5672271015', '9157011325', '7562077477', '3824465491',
        '0826343269', '0130354134', '2645297810', '6106507337', '1443341525', '9038122364', '7062942064', '6207741098',
        '4884473372', '3011770343', '9994757534', '3156632276', '3022639447', '6537157574', '6664124504', '8746651069',
        '1967178701', '9069441252', '7658910152', '0313353671', '2697436623', '2597491640', '4120107380', '9893122900',
        '4603804311', '0322803092', '4188114221', '0532790364', '5347225491', '7544543135', '2266082920', '0726711685',
        '8547059202', '3586745558', '9728596272', '1005660583', '9930652625', '6281398445', '8929871800', '3045038994',
        '1097458717', '8179748468', '5034905266', '6037122826', '8825038601', '6683621384', '6709954879', '0180631414',
        '0725971407', '7390544307', '5176469898', '3290931462', '3652327204', '8570422566', '0111228027', '1519036284',
        '9281571370', '2460806410', '5668652584', '2002940873', '8563864802', '2952463421', '3284100636', '9482645224',
        '7661963580', '1499443868', '4185471220', '6518129959', '4592647181', '9318055734', '4057239557', '8717852862',
        '2489549152', '6255731206', '4685081094', '0244651357', '6589833306', '8116500018', '6125306896', '8769993956',
        '0730440465', '5849458638', '4105113825', '1159211679', '7610066269', '3180678321', '7395198948', '8777811066',
        '1566802487', '8152842018', '9350403586', '6894640490'
    ];

    const txCodes = [
        '7752443124', '5562720826', '6543449282', '1713811325', '9281684046', '9197287645', '5496477156', '3995062342',
        '2786427639', '2381320898', '5017974978', '7723266348', '0745706274', '7244649157', '0794025714', '3116919006',
        '6242303225', '0927120586', '7416152258', '3522471214', '6572789850', '4711330065', '6293560878', '4080952928',
        '9416593330', '6890815136', '6786816970', '6725777996', '3884593001', '4682247144', '1966238137', '9118078687',
        '4011731621', '0065331693', '5458125218', '8382776586', '3352024801', '3186580688', '7438274921', '3663194848',
        '0214255224', '8538415093', '2725618915', '5126056438', '6730754440', '5078300426', '7374468915', '0258661686',
        '0758456175', '6706907619', '0801744253', '1161730562', '3784858678', '1355836431', '0060504699', '4926386616',
        '0979929738', '1291880585', '9679982853', '4195487374', '6324776935', '5349702466', '3295572457', '2446419226',
        '6015922120', '3460915864', '4796642544', '1166349822', '6038939517', '1003594280', '5288956333', '3148885245',
        '5295857400', '0886986554', '1414389464', '7792018975', '3375133277', '3979416917', '5530531785', '6706774024',
        '6882111084', '6125234794', '9280740657', '2171750149', '6718683961', '5270980521', '8878187730', '0754919889',
        '7157888969', '8034301273', '6153713803', '7663390007', '5425952020', '4291303257', '3855058482', '2594669064',
        '0206712654', '6866964741', '7545400485', '5017974978'
    ];

    function normalizePhone(phone) {
        return phone.replace(/[^0-9]/g, '');
    }

    phoneForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const phone = normalizePhone(phoneInput.value);
        const testKey = database[phone];
        if (testKey) {
            const testNumber = parseInt(testKey.replace('TEST', ''), 10);
            testNumberInput.value = `TEST${testNumber}`;
            rxCodeInput.value = rxCodes[testNumber - 1];
            txCodeInput.value = txCodes[testNumber - 1];
            resultMessage.textContent = '';
        } else {
            testNumberInput.value = '';
            rxCodeInput.value = '';
            txCodeInput.value = '';
            resultMessage.textContent = '해당 휴대폰 번호를 찾을 수 없습니다.';
        }
    });

    copyRxButton.addEventListener('click', () => {
        if (rxCodeInput.value) {
            navigator.clipboard.writeText(rxCodeInput.value).then(() => {
                alert('RX 접근키가 클립보드에 복사되었습니다.');
            });
        }
    });

    copyTxButton.addEventListener('click', () => {
        if (txCodeInput.value) {
            navigator.clipboard.writeText(txCodeInput.value).then(() => {
                alert('TX 접근키가 클립보드에 복사되었습니다.');
            });
        }
    });

    testPageButton.addEventListener('click', () => {
        window.location.href = 'http://13.125.255.210:8080/login';
    });
});
